<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fixing GitHub Pages Custom Domain Redirect Loop - Bin Huang's Blog</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <nav>
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/#about">About</a></li>
                    <li><a href="/#blogs">Blogs</a></li>
                    <li><a href="/#contact">Contact</a></li>
                </ul>
            </nav>
        </header>

        <main>
            <article class="blog-post">
                <h1>Fixing GitHub Pages Custom Domain Redirect Loop</h1>
                <p class="post-date">March 2, 2025</p>
                <div class="post-content">
                    <p>While migrating my personal website from Squarespace to GitHub Pages and configuring a custom domain, I encountered a redirect loop issue. The website was stuck in an infinite redirect loop between the www and non-www versions.</p>
                    
                    <h2>The Problem</h2>
                    <p>The redirect loop occurred due to conflicting configurations:</p>
                    <ul>
                        <li>Incorrect Domain Configuration:
                            <ul>
                                <li>CNAME file in GitHub repo set to: binhuang.dev</li>
                                <li>DNS A Records pointing binhuang.dev → GitHub IPs</li>
                                <li>DNS CNAME record pointing www.binhuang.dev → GitHub Pages</li>
                            </ul>
                        </li>
                        <li>This mixed configuration caused GitHub Pages to redirect between:
                            binhuang.dev ↔ www.binhuang.dev repeatedly</li>
                    </ul>

                    <h2>The Solution</h2>
                    <p>The fix was to use www subdomain as the primary domain in github pages:</p>
                    <ul>
                        <li>Set GitHub Pages custom domain to www.binhuang.dev instead of binhuang.dev</li>
                        <li>This works because:
                            <ul>
                                <li>CNAME record provides clean, unambiguous routing to GitHub Pages</li>
                                <li>No conflict with any existing apex domain settings</li>
                                <li>GitHub Pages can properly manage all redirects when it's the primary handler</li>
                            </ul>
                        </li>
                    </ul>

                    <h2>Understanding DNS Configuration</h2>
                    <p>Let's understand how DNS (Domain Name System) works in detail, as this is crucial to understanding both the problem and the solution:</p>

                    <ul>
                        <li>DNS is like the internet's phone book, translating human-readable domain names into IP addresses</li>
                        <li>Different types of DNS records serve different purposes:
                            <ul>
                                <li>A records: Direct mapping of a domain to IP addresses
                                    <ul>
                                        <li>Pros: Direct routing</li>
                                        <li>Cons: Must be manually updated if IPs change</li>
                                    </ul>
                                </li>
                                <li>CNAME records: Alias one domain name to another domain name
                                    <ul>
                                        <li>Pros: Flexible, automatically follows target domain's IP changes</li>
                                        <li>Cons: Slightly longer resolution time (needs extra lookup)</li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li>The apex domain (e.g., example.com) and www subdomain (www.example.com) are technically different and can be configured differently</li>
                    </ul>

                    <div class="diagram">
                        <h4>DNS Resolution Process</h4>
                        <pre class="ascii-diagram">
Browser            DNS Resolver         GitHub Pages
 |                     |                     |
 |  www.binhuang.dev?  |                     |
 |-------------------→ |                     |
 |                     |                     |
 |                     |  [DNS Lookup]       |
 |                     |  CNAME → github.io  |
 |                     |  Then IP lookup     |
 |                     |                     |
 |    IP Address       |                     |
 | ←------------------ |                     |
 |                     |                     |
 |         HTTP Request to IP                |
 |-----------------------------------------→ |
 |                     |                     |
 |         Website Content                   |
 | ←-----------------------------------------|</pre>
                    </div>

                    <h4>Step-by-Step DNS Resolution</h4>
                    <ol>
                        <li>Browser Request:
                            <ul>
                                <li>User types www.binhuang.dev in browser</li>
                                <li>Browser asks local DNS resolver for the IP address</li>
                            </ul>
                        </li>
                        <li>DNS Lookup:
                            <ul>
                                <li>DNS resolver checks CNAME record for www.binhuang.dev</li>
                                <li>Finds it points to robin-codespace.github.io</li>
                                <li>Then resolves GitHub Pages' domain to actual IP addresses</li>
                            </ul>
                        </li>
                        <li>Connection:
                            <ul>
                                <li>Browser connects to GitHub's servers using the resolved IP</li>
                                <li>GitHub serves your website content</li>
                            </ul>
                        </li>
                    </ol>

                    <h2>Important Notes</h2>
                    <ul>
                        <li>Remove all old DNS records to avoid conflicts</li>
                        <li>Website might be temporarily inaccessible during DNS propagation</li>
                        <li>If using HTTPS, wait for certificate configuration to complete</li>
                    </ul>
                </div>
            </article>
        </main>

        <footer>
            <p>© 2025 Bin Huang's Blog. All rights reserved.</p>
        </footer>
    </div>
</body>
</html>